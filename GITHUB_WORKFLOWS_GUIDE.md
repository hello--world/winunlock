# GitHub MCP Server 工作流程（Workflows）功能指南

GitHub MCP Server 提供了完整的工作流程（GitHub Actions）管理功能，可以直接在 Cursor 中检查构建状态、获取日志等。

## 🎯 核心功能

GitHub MCP Server 提供了以下工作流程相关功能：

1. **list_workflows** - 列出存储库中的所有工作流程
2. **list_workflow_runs** - 列出特定工作流程的运行（支持过滤）
3. **get_workflow_run** - 获取工作流程运行的详细信息
4. **get_workflow_run_logs** - 下载工作流程运行的日志
5. **get_workflow_run_usage** - 获取使用指标和计费信息

## 📝 在 Cursor 中的使用方法

### 1. 列出所有工作流程

```
你: "列出 winunlock 仓库的所有工作流程"
```

这会显示仓库中定义的所有 GitHub Actions 工作流程，例如：
- `Build WinUnlock` (来自 `.github/workflows/build.yml`)

### 2. 查看工作流程运行

#### 列出所有运行
```
你: "列出 Build WinUnlock 工作流程的运行"
```

#### 按状态过滤
```
你: "列出状态为失败的工作流程运行"
你: "列出状态为成功的工作流程运行"
你: "列出状态为进行中的工作流程运行"
```

#### 按分支过滤
```
你: "列出分支为 dev 的工作流程运行"
你: "列出分支为 main 的工作流程运行"
```

#### 组合过滤
```
你: "列出 Build WinUnlock 工作流程的运行，状态为失败，分支为 dev"
```

### 3. 获取运行详情

```
你: "获取工作流程运行 #123 的详情"
你: "获取最新工作流程运行的详情"
```

这会返回：
- 运行状态（成功/失败/进行中）
- 触发原因（push/pull_request/tag）
- 提交 SHA
- 分支信息
- 开始和完成时间
- 等等

### 4. 下载运行日志 ⭐

这是最实用的功能，可以直接获取构建错误：

```
你: "下载工作流程运行 #123 的日志"
你: "下载最新工作流程运行的日志"
你: "下载最新失败的工作流程运行的日志"
```

日志包含：
- 所有构建步骤的输出
- 错误信息
- 警告信息
- 完整的构建过程

### 5. 获取使用指标

```
你: "获取工作流程运行的使用指标"
```

## 🔄 完整自动化工作流示例

### 场景：检查构建并修复错误

```
1. 你推送代码后
   你: "列出 Build WinUnlock 工作流程的最新运行"

2. AI 显示运行状态
   AI: "运行 #456，状态：失败，分支：dev"

3. 获取错误日志
   你: "下载运行 #456 的日志"

4. AI 分析错误
   AI: [显示日志] "错误：缺少头文件 'credentialprovider.h'"

5. 修复错误
   你: "根据这个错误修复代码"

6. 再次检查
   你: "列出最新运行"
   AI: "运行 #457，状态：成功 ✅"
```

### 场景：监控构建状态

```
你: "列出状态为进行中的工作流程运行"
AI: [显示正在运行的构建]

你: "等待 30 秒后再次检查"
[等待]

你: "获取运行 #123 的详情"
AI: [显示最新状态]
```

### 场景：查找失败的构建

```
你: "列出状态为失败的工作流程运行，分支为 dev"
AI: [列出所有失败的运行]

你: "下载运行 #456 的日志"
AI: [显示完整错误日志]

你: "分析这些错误并修复"
AI: [分析并修复代码]
```

## 💡 实用技巧

### 1. 快速检查最新构建

```
你: "获取最新工作流程运行的详情"
```

### 2. 获取失败构建的日志

```
你: "列出状态为失败的工作流程运行"
你: "下载运行 #123 的日志"
```

### 3. 监控特定分支

```
你: "列出分支为 dev 的工作流程运行"
```

### 4. 查看特定工作流程

```
你: "列出 Build WinUnlock 工作流程的运行"
```

## 🔗 与其他功能结合

### 结合 PR 检查

```
1. 你: "列出所有打开的 PR"
2. 你: "获取 PR #123 的状态"  # 查看 PR 状态
3. 你: "列出与 PR #123 相关的工作流程运行"  # 查看构建状态
4. 你: "下载相关运行 #456 的日志"  # 获取构建日志
```

### 结合代码搜索

```
1. 你: "列出状态为失败的工作流程运行"
2. 你: "下载运行 #123 的日志"
3. AI: "错误：未定义的函数 'validatePassword'"
4. 你: "搜索包含 'validatePassword' 的代码"
5. 你: "修复这个错误"
```

## 📊 工作流程运行状态

工作流程运行可能的状态：
- **queued** - 排队中
- **in_progress** - 进行中
- **completed** - 已完成（可能成功或失败）
- **success** - 成功
- **failure** - 失败
- **cancelled** - 已取消

## 🎯 最佳实践

1. **推送后立即检查**：推送代码后立即查看最新运行
2. **使用日志定位问题**：失败时下载完整日志分析
3. **按分支过滤**：只查看相关分支的运行
4. **监控进行中的构建**：定期检查进行中的运行
5. **结合 PR 使用**：在 PR 中查看构建状态

## ⚠️ 注意事项

- 工作流程运行日志可能很大，下载需要时间
- 某些运行可能已经过期被删除
- 使用指标需要适当的权限
- 日志下载可能需要一些时间，请耐心等待

## 🚀 快速参考

| 功能 | 命令示例 |
|------|---------|
| 列出所有工作流程 | `"列出所有工作流程"` |
| 列出运行 | `"列出 Build WinUnlock 工作流程的运行"` |
| 过滤失败运行 | `"列出状态为失败的工作流程运行"` |
| 获取运行详情 | `"获取工作流程运行 #123 的详情"` |
| 下载日志 | `"下载工作流程运行 #123 的日志"` |
| 最新运行 | `"获取最新工作流程运行的详情"` |

---

**现在你可以在 Cursor 中直接管理 GitHub Actions 工作流程了！** 🎉

