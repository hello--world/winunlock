# 完全自动化构建工作流 - Cursor AI 版本

这个工作流让你可以在 Cursor 中通过自然语言命令实现完全自动化构建，直到编译成功。

## 🎯 使用方法

### 一键启动完全自动化

在 Cursor 聊天中，直接说：

```
"帮我实现完全自动化构建，自动检查构建状态，如果失败就分析错误并修复，重复直到编译成功"
```

或者：

```
"自动修复构建错误直到成功"
```

## 🔄 完整自动化流程

AI 会执行以下步骤：

### 步骤 1: 检查当前状态
```
AI: "让我先检查当前的构建状态..."
AI: [使用 GitHub MCP] "列出 Build WinUnlock 工作流程的最新运行"
```

### 步骤 2: 如果有未提交的更改，先提交
```
AI: "检查是否有未提交的更改..."
AI: [检查 Git 状态]
AI: "发现未提交的更改，正在提交..."
AI: [提交并推送]
```

### 步骤 3: 等待并检查构建状态
```
AI: "等待 GitHub Actions 构建完成..."
AI: [定期检查] "构建状态：进行中..."
AI: [检查完成] "构建状态：失败"
```

### 步骤 4: 如果失败，获取错误日志
```
AI: "构建失败，正在获取错误日志..."
AI: [使用 GitHub MCP] "下载最新失败的工作流程运行的日志"
AI: [分析日志] "错误分析：缺少头文件 'credentialprovider.h'"
```

### 步骤 5: 自动修复错误
```
AI: [分析代码] "找到问题，正在修复..."
AI: [修复代码] "已添加缺失的头文件"
AI: [提交修复] "修复已提交并推送"
```

### 步骤 6: 再次检查构建
```
AI: "等待新的构建完成..."
AI: [检查] "构建状态：成功 ✅"
AI: "🎉 构建成功！任务完成！"
```

### 步骤 7: 如果还是失败，重复步骤 3-6

## 📋 分步命令（如果你想手动控制）

如果你想分步执行，可以使用以下命令：

### 1. 检查构建状态
```
"列出 Build WinUnlock 工作流程的最新运行"
"获取最新工作流程运行的详情"
```

### 2. 获取错误日志
```
"下载最新失败的工作流程运行的日志"
"获取工作流程运行 #123 的日志"
```

### 3. 分析并修复
```
"根据这个构建错误修复代码：[粘贴错误信息]"
"分析这个编译错误并自动修复：[错误]"
```

### 4. 提交并推送
```
"提交修复并推送到 dev 分支"
```

### 5. 再次检查
```
"再次检查最新工作流程运行的状态"
```

## 🤖 智能自动化命令

### 命令 1: 完全自动化（推荐）
```
"自动修复构建错误直到成功，最多重试 10 次"
```

### 命令 2: 检查并修复一次
```
"检查构建状态，如果失败就修复并重新构建"
```

### 命令 3: 分析失败原因
```
"分析最近 3 次失败的构建，找出共同原因并修复"
```

### 命令 4: 监控构建
```
"监控最新的构建，如果失败立即通知我并自动修复"
```

## 🔧 高级功能

### 自动重试配置

在命令中指定重试次数：
```
"自动修复构建错误直到成功，最多重试 5 次"
```

### 指定工作流程

如果有多个工作流程：
```
"检查 'Build WinUnlock' 工作流程的构建状态并自动修复"
```

### 指定分支

```
"检查 dev 分支的构建状态并自动修复"
```

## 📊 实际使用示例

### 示例 1: 完全自动化

```
你: "帮我实现完全自动化构建，直到编译成功"

AI: [开始自动化流程]
AI: "1. 检查当前构建状态..."
AI: [检查] "最新运行 #456，状态：失败"
AI: "2. 获取错误日志..."
AI: [下载日志] "错误：缺少头文件"
AI: "3. 修复错误..."
AI: [修复代码] "已添加缺失的头文件"
AI: "4. 提交并推送..."
AI: [提交推送] "已推送"
AI: "5. 等待新构建..."
AI: [等待并检查] "✅ 构建成功！"
```

### 示例 2: 分步控制

```
你: "检查构建状态"
AI: [检查] "构建失败"

你: "下载错误日志"
AI: [下载] "错误：..."

你: "修复这个错误"
AI: [修复] "已修复"

你: "提交并再次检查"
AI: [提交并检查] "✅ 成功"
```

## ⚙️ 配置选项

### 设置检查间隔

```
"检查构建状态，每 30 秒检查一次"
```

### 设置超时时间

```
"自动修复构建错误，最多等待 10 分钟"
```

### 设置最大重试次数

```
"自动修复构建错误，最多重试 5 次"
```

## 🎯 最佳实践

1. **使用完全自动化命令**：最简单高效
2. **小步提交**：每次修复一个错误
3. **及时检查**：推送后立即检查
4. **利用 AI 分析**：让 AI 分析错误模式
5. **查看历史**：分析多次失败找出规律

## 🚨 故障排除

### 构建一直失败

```
"分析最近 5 次失败的构建，找出根本原因并修复"
```

### 无法获取工作流程运行

```
"列出所有工作流程"
"列出 Build WinUnlock 工作流程的运行"
```

### 需要手动干预

```
"暂停自动化，让我手动修复这个错误"
```

---

**现在你可以在 Cursor 中实现完全自动化的构建流程了！** 🎉

只需说："自动修复构建错误直到成功"

